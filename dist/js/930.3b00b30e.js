"use strict";(self["webpackChunkapi_test_vue"]=self["webpackChunkapi_test_vue"]||[]).push([[930],{8789:function(e,l,a){a.r(l),a.d(l,{default:function(){return T}});var t=a(6768),u=a(144),n=a(3898),s=a(9620),d=a(1229),o=a(6261),r=a(3318),i=a(3923),c=a(1552),p=a(2469),m=a(1219),b=a(2213);const k={class:"title"},f={class:"mt-4"},F={key:0},_={key:1},v={key:2},g={class:"div",style:{height:"225px"}},h={class:"dialog-footer"};var y={__name:"InterFaceDebug",setup(e){(0,t.xo)((()=>{console.log("Component is about to be unmounted")}));var l=(0,u.KR)("json"),a=(0,u.Kh)({interface:{url:"",method:"GET"},headers:"{}",request:{json:"{}",data:"{}",params:"{}"},file:[],setup_script:"",teardown_script:""}),y=(0,p.N)(),V=(0,u.KR)({});async function R(){const e={env:y.env,cases:{title:"调试运行",interface:a.interface,headers:JSON.parse(a.headers),request:{params:JSON.parse(a.request.params)},setup_script:a.setup_script,teardown_script:a.teardown_script}};"json"===l.value?e.cases.request.json=JSON.parse(a.request.json):"data"===l.value?e.cases.request.data=JSON.parse(a.request.data):"form_data"===l.value&&(e.cases.request.file=a.request.file);var t=await c.A.runInterFaceCase(e);200===t.status?V.value=t.data:(0,m.nk)({type:"error",message:"用例执行异常"})}var w=(0,u.KR)(!1),L=(0,u.Kh)({name:"",interface_id:null});function C(){w.value=!0,L.name="",L.interface_id=null}async function U(){var e={interface:L.interface_id,headers:JSON.parse(a.headers),request:{json:JSON.parse(a.request.json),data:JSON.parse(a.request.data),params:JSON.parse(a.request.params)},file:a.file,setup_script:a.setup_script,teardown_script:a.teardown_script,title:L.name},l=await c.A.addInterFaceCase(e);201===l.status?((0,m.nk)({type:"success",message:"保存用例成功"}),w.value=!1):(0,m.nk)({type:"error",message:"保存用例失败"})}return(e,c)=>{const p=(0,t.g2)("el-button"),m=(0,t.g2)("el-option"),x=(0,t.g2)("el-select"),q=(0,t.g2)("el-input"),W=(0,t.g2)("el-divider"),j=(0,t.g2)("el-tab-pane"),A=(0,t.g2)("el-radio-button"),E=(0,t.g2)("el-radio-group"),I=(0,t.g2)("el-tabs"),N=(0,t.g2)("el-form-item"),T=(0,t.g2)("el-form"),K=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("div",k,[c[16]||(c[16]=(0,t.Lk)("div",null,null,-1)),c[17]||(c[17]=(0,t.Lk)("span",null,"接口调试",-1)),(0,t.bF)(p,{type:"primary",onClick:C},{default:(0,t.k6)((()=>c[15]||(c[15]=[(0,t.eW)("保存")]))),_:1})]),(0,t.Lk)("div",f,[(0,t.bF)(q,{modelValue:(0,u.R1)(a).interface.url,"onUpdate:modelValue":c[2]||(c[2]=e=>(0,u.R1)(a).interface.url=e),style:{"max-width":"100%"},placeholder:"请输入url路径",class:"input-with-select"},{prepend:(0,t.k6)((()=>[(0,t.bF)(x,{modelValue:(0,u.R1)(a).interface.method,"onUpdate:modelValue":c[0]||(c[0]=e=>(0,u.R1)(a).interface.method=e),placeholder:"请求方法",style:{width:"115px"}},{default:(0,t.k6)((()=>[(0,t.bF)(m,{label:"GET",value:"get"}),(0,t.bF)(m,{label:"POST",value:"post"}),(0,t.bF)(m,{label:"PUT",value:"put"}),(0,t.bF)(m,{label:"PATCH",value:"patch"}),(0,t.bF)(m,{label:"DELETE",value:"delete"})])),_:1},8,["modelValue"])])),append:(0,t.k6)((()=>[(0,t.bF)(p,{type:"primary",onClick:c[1]||(c[1]=e=>R())},{default:(0,t.k6)((()=>c[18]||(c[18]=[(0,t.eW)("运行")]))),_:1})])),_:1},8,["modelValue"])]),(0,t.bF)(W,{"content-position":"left"},{default:(0,t.k6)((()=>c[19]||(c[19]=[(0,t.eW)("请求信息")]))),_:1}),(0,t.bF)(I,{type:"border-card",class:"demo-tabs"},{default:(0,t.k6)((()=>[(0,t.bF)(j,null,{label:(0,t.k6)((()=>c[20]||(c[20]=[(0,t.Lk)("span",{class:"custom-tabs-label"},[(0,t.Lk)("img",{src:n,width:"15",style:{"margin-right":"10px"}}),(0,t.Lk)("span",null,"请求头")],-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(i.A,{modelValue:(0,u.R1)(a).headers,"onUpdate:modelValue":c[3]||(c[3]=e=>(0,u.R1)(a).headers=e),lang:"json"},null,8,["modelValue"])])),_:1}),(0,t.bF)(j,null,{label:(0,t.k6)((()=>c[21]||(c[21]=[(0,t.Lk)("span",{class:"custom-tabs-label"},[(0,t.Lk)("img",{src:s,width:"15",style:{"margin-right":"10px"}}),(0,t.Lk)("span",null,"查询参数")],-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(i.A,{modelValue:(0,u.R1)(a).request.params,"onUpdate:modelValue":c[4]||(c[4]=e=>(0,u.R1)(a).request.params=e),lang:"json"},null,8,["modelValue"])])),_:1}),(0,t.bF)(j,null,{label:(0,t.k6)((()=>c[22]||(c[22]=[(0,t.Lk)("span",{class:"custom-tabs-label"},[(0,t.Lk)("img",{src:d,width:"15",style:{"margin-right":"10px"}}),(0,t.Lk)("span",null,"请求体")],-1)]))),default:(0,t.k6)((()=>[(0,t.Lk)("div",null,[(0,t.bF)(E,{modelValue:(0,u.R1)(l),"onUpdate:modelValue":c[5]||(c[5]=e=>(0,u.i9)(l)?l.value=e:l=e),size:"small"},{default:(0,t.k6)((()=>[(0,t.bF)(A,{value:"json"},{default:(0,t.k6)((()=>c[23]||(c[23]=[(0,t.eW)("json")]))),_:1}),(0,t.bF)(A,{value:"form_data"},{default:(0,t.k6)((()=>c[24]||(c[24]=[(0,t.eW)("form-data")]))),_:1}),(0,t.bF)(A,{value:"data"},{default:(0,t.k6)((()=>c[25]||(c[25]=[(0,t.eW)("x-www-form-urlencoded")]))),_:1})])),_:1},8,["modelValue"]),"json"===(0,u.R1)(l)?((0,t.uX)(),(0,t.CE)("div",F,[(0,t.bF)(i.A,{modelValue:(0,u.R1)(a).request.json,"onUpdate:modelValue":c[6]||(c[6]=e=>(0,u.R1)(a).request.json=e),lang:"json"},null,8,["modelValue"])])):"data"===(0,u.R1)(l)?((0,t.uX)(),(0,t.CE)("div",_,[(0,t.bF)(i.A,{modelValue:(0,u.R1)(a).request.data,"onUpdate:modelValue":c[7]||(c[7]=e=>(0,u.R1)(a).request.data=e),lang:"json"},null,8,["modelValue"])])):((0,t.uX)(),(0,t.CE)("div",v,[(0,t.Lk)("div",g,[(0,t.bF)(r.A,{modelValue:(0,u.R1)(a).file,"onUpdate:modelValue":c[8]||(c[8]=e=>(0,u.R1)(a).file=e)},null,8,["modelValue"])])]))])])),_:1}),(0,t.bF)(j,null,{label:(0,t.k6)((()=>c[26]||(c[26]=[(0,t.Lk)("span",{class:"custom-tabs-label"},[(0,t.Lk)("img",{src:o,width:"15",style:{"margin-right":"10px"}}),(0,t.Lk)("span",null,"前置脚本")],-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(i.A,{modelValue:(0,u.R1)(a).setup_script,"onUpdate:modelValue":c[9]||(c[9]=e=>(0,u.R1)(a).setup_script=e),lang:"python",height:"225px"},null,8,["modelValue"])])),_:1}),(0,t.bF)(j,null,{label:(0,t.k6)((()=>c[27]||(c[27]=[(0,t.Lk)("span",{class:"custom-tabs-label"},[(0,t.Lk)("img",{src:o,width:"15",style:{"margin-right":"10px"}}),(0,t.Lk)("span",null,"后置脚本")],-1)]))),default:(0,t.k6)((()=>[(0,t.bF)(i.A,{modelValue:(0,u.R1)(a).teardown_script,"onUpdate:modelValue":c[10]||(c[10]=e=>(0,u.R1)(a).teardown_script=e),lang:"python",height:"225px"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.bF)(W,{"content-position":"left"},{default:(0,t.k6)((()=>c[28]||(c[28]=[(0,t.eW)("响应信息")]))),_:1}),(0,t.bF)(b.A,{result:(0,u.R1)(V)},null,8,["result"]),(0,t.bF)(K,{modelValue:(0,u.R1)(w),"onUpdate:modelValue":c[14]||(c[14]=e=>(0,u.i9)(w)?w.value=e:w=e),title:"保存用例请选择对应的接口",width:"500"},{footer:(0,t.k6)((()=>[(0,t.Lk)("div",h,[(0,t.bF)(p,{onClick:c[13]||(c[13]=e=>(0,u.i9)(w)?w.value=!1:w=!1)},{default:(0,t.k6)((()=>c[29]||(c[29]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(p,{type:"primary",onClick:U},{default:(0,t.k6)((()=>c[30]||(c[30]=[(0,t.eW)(" 确认 ")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.bF)(T,{model:(0,u.R1)(L)},{default:(0,t.k6)((()=>[(0,t.bF)(N,{label:"用例名称","label-width":e.formLabelWidth},{default:(0,t.k6)((()=>[(0,t.bF)(q,{modelValue:(0,u.R1)(L).name,"onUpdate:modelValue":c[11]||(c[11]=e=>(0,u.R1)(L).name=e),autocomplete:"on"},null,8,["modelValue"])])),_:1},8,["label-width"]),(0,t.bF)(N,{label:"选择接口","label-width":e.formLabelWidth},{default:(0,t.k6)((()=>[(0,t.bF)(x,{modelValue:(0,u.R1)(L).interface_id,"onUpdate:modelValue":c[12]||(c[12]=e=>(0,u.R1)(L).interface_id=e),placeholder:"请选择接口"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)((0,u.R1)(y).inetrfaces,(e=>((0,t.uX)(),(0,t.Wv)(m,{label:e.name,value:e.id},null,8,["label","value"])))),256))])),_:1},8,["modelValue"])])),_:1},8,["label-width"])])),_:1},8,["model"])])),_:1},8,["modelValue"])],64)}}},V=a(1241);const R=(0,V.A)(y,[["__scopeId","data-v-55e02739"]]);var w=R,L=a(2933);const C={class:"demo-drawer__content"},U={class:"demo-drawer__footer"};var x={__name:"InterFaceList",props:{interface:[]},setup(e){var l=(0,u.KR)(!1);const a=(0,p.N)();var n=(0,u.KR)("添加接口"),s=(0,u.Kh)({name:"",url:"",method:"get",type:"1",project:a.pro.id});function d(){n.value="添加接口",l.value=!0,s.name="",s.url="",s.method="get",s.type="1"}function o(){l.value=!1}async function r(){var e=await c.A.addInterFace(s);201===e.status?((0,m.nk)({type:"success",message:"添加成功"}),a.getInterFaces(),l.value=!1):(0,m.nk)({type:"error",message:"添加失败"})}function i(e){L.s.confirm("接口用例删除以后数据不可恢复，确认删除吗","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{const l=await c.A.delInterFace(e);204===l.status?((0,m.nk)({type:"success",message:"删除成功"}),a.getInterFaces()):(0,m.nk)({type:"error",message:"删除失败"})})).catch((()=>{(0,m.nk)({type:"info",message:"已取消"})}))}function b(e){n.value="编辑接口",l.value=!0,s.name=e.name,s.url=e.url,s.method=e.method,s.type=e.type,s.id=e.id}async function k(e){const t=await c.A.updateInterFace(e.id,s);200===t.status?((0,m.nk)({type:"success",message:"更改成功"}),a.getInterFaces(),l.value=!1):((0,m.nk)({type:"error",message:"更改失败"}),l.value=!1)}return(a,c)=>{const p=(0,t.g2)("el-button"),m=(0,t.g2)("el-table-column"),f=(0,t.g2)("el-table"),F=(0,t.g2)("el-input"),_=(0,t.g2)("el-form-item"),v=(0,t.g2)("el-option"),g=(0,t.g2)("el-select"),h=(0,t.g2)("el-form"),y=(0,t.g2)("el-drawer");return(0,t.uX)(),(0,t.CE)(t.FK,null,[c[10]||(c[10]=(0,t.Lk)("div",null,null,-1)),(0,t.Lk)("div",null,[(0,t.bF)(p,{type:"primary",onClick:d},{default:(0,t.k6)((()=>c[6]||(c[6]=[(0,t.eW)("添加接口")]))),_:1})]),(0,t.bF)(f,{data:e.interface,border:"",style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(m,{prop:"name",label:"接口名称",width:"150"}),(0,t.bF)(m,{prop:"url",label:"接口地址",width:"260"}),(0,t.bF)(m,{prop:"method",label:"请求方法",width:"180"}),(0,t.bF)(m,{label:"操作"},{default:(0,t.k6)((e=>[(0,t.bF)(p,{type:"primary",icon:"Edit",circle:"",plain:"",onClick:l=>b(e.row)},null,8,["onClick"]),(0,t.bF)(p,{type:"danger",icon:"Delete",circle:"",plain:"",onClick:l=>i(e.row.id)},null,8,["onClick"])])),_:1})])),_:1},8,["data"]),(0,t.bF)(y,{modelValue:(0,u.R1)(l),"onUpdate:modelValue":c[5]||(c[5]=e=>(0,u.i9)(l)?l.value=e:l=e),title:"title",direction:"rtl",class:"demo-drawer"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",C,[(0,t.bF)(h,{model:(0,u.R1)(s),"label-width":"auto",style:{"max-width":"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(_,{label:"接口名称"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:(0,u.R1)(s).name,"onUpdate:modelValue":c[0]||(c[0]=e=>(0,u.R1)(s).name=e)},null,8,["modelValue"])])),_:1}),(0,t.bF)(_,{label:"接口地址"},{default:(0,t.k6)((()=>[(0,t.bF)(F,{modelValue:(0,u.R1)(s).url,"onUpdate:modelValue":c[1]||(c[1]=e=>(0,u.R1)(s).url=e)},null,8,["modelValue"])])),_:1}),(0,t.bF)(_,{label:"请求方式"},{default:(0,t.k6)((()=>[(0,t.bF)(g,{modelValue:(0,u.R1)(s).method,"onUpdate:modelValue":c[2]||(c[2]=e=>(0,u.R1)(s).method=e)},{default:(0,t.k6)((()=>[(0,t.bF)(v,{label:"GET",value:"get"}),(0,t.bF)(v,{label:"POST",value:"post"}),(0,t.bF)(v,{label:"PATCH",value:"patch"}),(0,t.bF)(v,{label:"PUT",value:"put"}),(0,t.bF)(v,{label:"DELETE",value:"delete"})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(_,{label:"接口类型"},{default:(0,t.k6)((()=>[(0,t.bF)(g,{modelValue:(0,u.R1)(s).type,"onUpdate:modelValue":c[3]||(c[3]=e=>(0,u.R1)(s).type=e)},{default:(0,t.k6)((()=>[(0,t.bF)(v,{label:"项目接口",value:"1"}),(0,t.bF)(v,{label:"第三方接口",value:"2"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),(0,t.Lk)("div",U,[(0,t.bF)(p,{onClick:o,type:"info"},{default:(0,t.k6)((()=>c[7]||(c[7]=[(0,t.eW)("取消")]))),_:1}),"添加接口"===(0,u.R1)(n)?((0,t.uX)(),(0,t.Wv)(p,{key:0,type:"primary",onClick:r},{default:(0,t.k6)((()=>c[8]||(c[8]=[(0,t.eW)("确定")]))),_:1})):((0,t.uX)(),(0,t.Wv)(p,{key:1,type:"primary",onClick:c[4]||(c[4]=e=>k((0,u.R1)(s)))},{default:(0,t.k6)((()=>c[9]||(c[9]=[(0,t.eW)("确定")]))),_:1}))])])])),_:1},8,["modelValue"])],64)}}};const q=x;var W=q;const j={class:"main_box"},A={class:"card left_box"},E={class:"card right_box"};var I={__name:"InterFaceView",setup(e){const l=(0,p.N)();return(e,a)=>{const n=(0,t.g2)("el-tab-pane"),s=(0,t.g2)("el-tabs");return(0,t.uX)(),(0,t.CE)("div",j,[(0,t.Lk)("div",A,[(0,t.bF)(w)]),(0,t.Lk)("div",E,[a[1]||(a[1]=(0,t.Lk)("div",{class:"title",style:{"text-align":"center","font-weight":"bold",height:"30px"}},[(0,t.Lk)("div"),(0,t.Lk)("span",null,"接口调试"),(0,t.Lk)("div")],-1)),(0,t.bF)(s,{modelValue:e.activeName,"onUpdate:modelValue":a[0]||(a[0]=l=>e.activeName=l),type:"card",class:"demo-tabs"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{label:"项目接口"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{interface:(0,u.R1)(l).interface1},null,8,["interface"])])),_:1}),(0,t.bF)(n,{label:"第三方接口"},{default:(0,t.k6)((()=>[(0,t.bF)(W,{interface:(0,u.R1)(l).interface2},null,8,["interface"])])),_:1})])),_:1},8,["modelValue"])])])}}};const N=(0,V.A)(I,[["__scopeId","data-v-0c924aa8"]]);var T=N}}]);
//# sourceMappingURL=930.3b00b30e.js.map