{"version":3,"file":"js/549.ebbdc055.js","mappings":"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","sources":["webpack://api_test_vue/./src/views/home/testStep/TestCase.vue","webpack://api_test_vue/./src/views/home/testStep/TestCase.vue?d35e"],"sourcesContent":["<template>\r\n   <div class=\"demo-collapse\">\r\n    <el-collapse :model-value=\"['1','2','4','5','6']\">\r\n      <el-collapse-item name=\"1\">\r\n        <template #title>\r\n            <img src=\"@/assets/icons/icon-api-b.png\" width=\"20\" style=\"margin-right: 10px;\">\r\n            <b>API信息</b>\r\n        </template>\r\n        <div>\r\n            <el-input v-model=\"caseData.interface.url\" style=\"max-width: 100%\" class=\"input-with-select\" readonly>\r\n                <template #prepend>\r\n                    <el-select v-model=\"caseData.interface.method\" placeholder=\"请求方法\" style=\"width: 115px\">\r\n                    <el-option label=\"GET\" value=\"get\" />\r\n                    <el-option label=\"POST\" value=\"post\" />\r\n                    <el-option label=\"PUT\" value=\"put\" />\r\n                    <el-option label=\"PATCH\" value=\"patch\" />\r\n                    <el-option label=\"DELETE\" value=\"delete\" />\r\n                    </el-select>\r\n                </template>\r\n            </el-input>\r\n        </div>\r\n      </el-collapse-item>\r\n      <el-collapse-item name=\"2\">\r\n        <template #title>\r\n            <img src=\"@/assets/icons/case.png\" width=\"20\" style=\"margin-right: 10px;\">\r\n            <b>用例名称</b>\r\n        </template>\r\n        <div>\r\n            <el-input v-model=\"caseData.title\" label=\"用例名称\">\r\n                <template #prepend> <span>用例名称</span> </template>\r\n            </el-input>\r\n        </div>\r\n      </el-collapse-item>\r\n      <el-collapse-item name=\"3\">\r\n        <template #title>\r\n            <img src=\"@/assets/icons/instruction.png\" width=\"20\" style=\"margin-right: 10px;\">\r\n            <b>前置脚本</b>\r\n        </template>\r\n        <div class=\"script_code\">\r\n            <div class=\"edido\"><EditorCopmponts v-model=\"caseData.setup_script\"  lang=\"python\" height=\"225px\"></EditorCopmponts></div>\r\n            <div class=\"card mod\">\r\n                <div class=\"add_code\">\r\n                    <el-button @click='addSetupScript(\"func\")' plain size=\"small\" type=\"success\" style=\"margin-bottom: 8px;\">调用全局工具函数</el-button>\r\n                </div>\r\n                <div class=\"add_code\">\r\n                    <el-button @click='addSetupScript(\"global\")' plain size=\"small\" type=\"success\" style=\"margin-bottom: 8px;\">设置全局变量</el-button>\r\n                </div>\r\n                <div class=\"add_code\">\r\n                    <el-button @click='addSetupScript(\"env\")' plain size=\"small\" type=\"success\" style=\"margin-bottom: 8px;\">设置局部变量</el-button>\r\n                </div>\r\n                <div class=\"add_code\">\r\n                    <el-button @click='addSetupScript(\"sql\")' plain size=\"small\" type=\"success\" style=\"margin-bottom: 8px;\">执行sql查询</el-button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n      </el-collapse-item>\r\n      <el-collapse-item name=\"4\">\r\n        <template #title>\r\n            <img src=\"@/assets/icons/keyhole.png\" width=\"20\" style=\"margin-right: 10px;\">\r\n            <b>请求头</b>\r\n        </template>\r\n        <div>\r\n            <EditorCopmponts v-model=\"caseData.headers\"  lang=\"json\"></EditorCopmponts>\r\n        </div>\r\n      </el-collapse-item>\r\n      <el-collapse-item name=\"5\">\r\n        <template #title>\r\n            <img src=\"@/assets/icons/API_api.png\" width=\"20\" style=\"margin-right: 10px;\">\r\n            <b>查询参数</b>\r\n        </template>\r\n        <div>\r\n            <EditorCopmponts v-model=\"caseData.request.params\"  lang=\"json\"></EditorCopmponts>\r\n        </div>\r\n      </el-collapse-item>\r\n      <el-collapse-item name=\"6\">\r\n        <template #title>\r\n            <img src=\"@/assets/icons/body.png\" width=\"20\" style=\"margin-right: 10px;\">\r\n            <b>请求体</b>\r\n        </template>\r\n        <div>\r\n            <el-radio-group v-model=\"bodyType\" size=\"small\">\r\n                <el-radio-button value=\"json\">json</el-radio-button>\r\n                <el-radio-button value=\"form_data\">form-data</el-radio-button>\r\n                <el-radio-button value=\"data\">x-www-form-urlencoded</el-radio-button>\r\n            </el-radio-group>\r\n            <div v-if=\"bodyType==='json'\">\r\n                <EditorCopmponts v-model=\"caseData.request.json\"  lang=\"json\"></EditorCopmponts>\r\n            </div>\r\n            <div v-else-if=\"bodyType==='data'\">\r\n                <EditorCopmponts v-model=\"caseData.request.data\"  lang=\"json\"></EditorCopmponts>\r\n            </div>\r\n            <div v-else>\r\n                <div class=\"div\" style=\"height: 225px;\">\r\n                    <FromData v-model=\"caseData.file\"></FromData>\r\n                </div>\r\n            </div>\r\n        </div>\r\n      </el-collapse-item>\r\n      <el-collapse-item name=\"7\">\r\n        <template #title>\r\n            <img src=\"@/assets/icons/instruction.png\" width=\"20\" style=\"margin-right: 10px;\">\r\n            <b>后置断言脚本</b>\r\n        </template>\r\n        <div>\r\n            <div class=\"script_code\">\r\n            <div class=\"edido\"><EditorCopmponts v-model=\"caseData.teardown_script\"  lang=\"python\" height=\"225px\"></EditorCopmponts></div>\r\n            <div class=\"card mod\" style=\"overflow: auto;\">\r\n                <div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('func')\" plain size=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">调用全局工具函数</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('getBody')\" plain size=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">获取响应体</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('global')\" plain size=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">设置全局变量</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('env')\" plain size=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">设置局部变量</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('sql')\" plain size=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">执行sql查询</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('JSextract')\" plain\r\n\t\t\t\t\t\t\t\tsize=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">Jsonpath提取数据</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('REextract')\" plain size=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">正则提取数据</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('http')\" plain size=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">HTTP状态码断言</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('eq')\" plain size=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">断言相对</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"add_code\">\r\n\t\t\t\t\t\t\t<el-button @click=\"addTearDownCodeMod('contain')\" plain size=\"small\" type=\"success\" style=\"margin-bottom: 5px;\">断言包含</el-button>\r\n\t\t\t\t\t\t</div>\r\n                <!-- <div><el-button type=\"info\" plain size=\"small\" style=\"margin-bottom: 10px;\">Success</el-button></div> -->\r\n            </div>\r\n        </div>\r\n        </div>\r\n      </el-collapse-item>\r\n    </el-collapse>\r\n  </div>\r\n  <el-affix position=\"bottom\" :offset=\"40\">\r\n    <div class=\"buts\" v-if=\"case_id !==''\">\r\n    <el-button type=\"success\" size=\"small\" icon='Promotion' round @click=\"runCase\">运行</el-button>\r\n    \r\n    <el-button type=\"primary\" size=\"small\" round icon='CirclePlusFilled' @click=\"copyCase\" v-if=\"buts===''\">复制</el-button>\r\n    <el-button type=\"primary\" size=\"small\" round icon='SuccessFilled' @click=\"saveCase\">保存</el-button> \r\n    <el-button type=\"danger\" size=\"small\" round icon='DeleteFilled' @click=\"delCase\" v-if=\"buts===''\">删除</el-button>\r\n    <el-button style=\"flex:1;\" type=\"danger\" size=\"small\" round icon='View' @click=\"openResutl\">结果</el-button>\r\n    </div>\r\n  </el-affix>\r\n    <el-drawer v-model=\"drawer\" title=\"resData.name='测试结果'\" :with-header=\"true\" size=\"40%\">\r\n        <ResultView :result=\"resData\"></ResultView>\r\n    </el-drawer>\r\n  \r\n</template>\r\n\r\n<script setup>\r\nimport FromData from '@/components/FormData.vue'\r\nimport {ref,defineProps,reactive, watch} from 'vue'\r\nimport EditorCopmponts from '@/views/home/components/EditorCopmponts.vue';\r\nimport api from '@/api/index'\r\nimport {ProjectStore} from '@/store/modoles/proStore'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport ResultView from '@/components/ResultView.vue';\r\n\r\n\r\nvar drawer=ref(false)\r\nvar pstore=ProjectStore()\r\nvar props=defineProps({\r\n    case_id:'',\r\n    buts:''\r\n})\r\n// 查看运行接口\r\nfunction openResutl(){\r\n    drawer.value=true\r\n}\r\n\r\n// 用例绑定数据\r\nvar caseData=reactive({\r\n       interface: {\r\n            url: \"\",\r\n            method: \"GET\"\r\n           },\r\n        headers: \"{}\",\r\n        request: {\r\n            json: \"{}\",\r\n            data:\"{}\",\r\n            params:\"{}\"\r\n        },\r\n        file:[],\r\n        setup_script: \"\",\r\n        teardown_script: \"\",\r\n        title:''\r\n})\r\nvar bodyType=ref('json')\r\n// 获取用例详情的函数\r\nvar caseObj={}\r\nasync function getCaseInfo(case_id) {\r\n    const res=await api.getInterFacesCase(case_id)\r\n    if (res.status===200){\r\n        caseObj=res.data\r\n        caseData.title=caseObj.title\r\n        caseData.interface=caseObj.interface\r\n        caseData.setup_script=caseObj.setup_script\r\n        caseData.file=caseObj.file\r\n        caseData.teardown_script=caseObj.teardown_script\r\n        caseData.headers=JSON.stringify(caseObj.headers,0,4)\r\n        caseData.request.json=JSON.stringify(caseObj.request.json || {})\r\n        caseData.request.data=JSON.stringify(caseObj.request.data || {})\r\n        caseData.request.params=JSON.stringify(caseObj.request.params || {})\r\n    }\r\n    \r\n}\r\n\r\n// 监听函数监听case_id 的变化来更新用例参数\r\nwatch (() => props.case_id,(id) =>{\r\n    if (id !==''){\r\n        getCaseInfo(id)\r\n    }\r\n})\r\n\r\n// 清空数据\r\nfunction cleanData(){\r\n    caseData.title=''\r\n    caseData.interface={\r\n        method:'get',\r\n        url:''\r\n    }\r\n    caseData.setup_script=''\r\n    caseData.file=[]\r\n    caseData.teardown_script=''\r\n    caseData.headers='{}'\r\n    caseData.request.json='{}'\r\n    caseData.request.data='{}'\r\n    caseData.request.params='{}'\r\n    caseObj={}\r\n}\r\n\r\n// 删除测试用例\r\nfunction delCase(){\r\n    ElMessageBox.confirm(\r\n    `当前用例名称:${caseData.title} 删除后数据不可恢复`,\r\n    '警告',\r\n    {\r\n      confirmButtonText: '确认',\r\n      cancelButtonText: '取消',\r\n      type: 'warning',\r\n    }\r\n  )\r\n    .then(async() => {\r\n        const res=await api.delInterFaceCase(props.case_id)\r\n        if (res.status===204){\r\n            ElMessage({\r\n            type: 'success',\r\n            message: '删除成功',})\r\n            pstore.getInterFaces()\r\n            cleanData()\r\n        }\r\n        else{\r\n            ElMessage({\r\n            type: 'error',\r\n            message: '删除失败',})\r\n        }\r\n   })\r\n    .catch(() => {\r\n      ElMessage({\r\n        type: 'info',\r\n        message: '取消删除',\r\n      })\r\n    })\r\n}\r\nvar newCaseData=reactive({\r\n       interface: {\r\n            url: \"\",\r\n            method: \"GET\"\r\n           },\r\n        headers: \"{}\",\r\n        request: {\r\n            json: \"{}\",\r\n            data:\"{}\",\r\n            params:\"{}\"\r\n        },\r\n        file:[],\r\n        setup_script: \"\",\r\n        teardown_script: \"\",\r\n        title:''\r\n})\r\n// 复制测试用例\r\nasync function copyCase(){\r\n    newCaseData.title=caseData.title+'+Copy'\r\n    newCaseData.interface=caseData.interface.id\r\n    newCaseData.setup_script=caseData.setup_script\r\n    newCaseData.teardown_script=caseData.teardown_script\r\n    newCaseData.headers=JSON.parse(caseData.headers)\r\n    newCaseData.request.json=JSON.parse(caseData.request.json)\r\n    newCaseData.request.data=JSON.parse(caseData.request.data)\r\n    newCaseData.request.params=JSON.parse(caseData.request.params)\r\n    const res=await api.addInterFaceCase(newCaseData)\r\n    if (res.status===201){\r\n        ElMessage({\r\n            type: 'success',\r\n            message: '复制成功',})\r\n            pstore.getInterFaces()\r\n    }else{\r\n        ElMessage({\r\n            type: 'error',\r\n            message: '复制失败',})\r\n    }\r\n}\r\n\r\n//  保存测试用例\r\nasync function saveCase() {\r\n    newCaseData.title=caseData.title\r\n    newCaseData.interface=caseData.interface.id\r\n    newCaseData.setup_script=caseData.setup_script\r\n    newCaseData.teardown_script=caseData.teardown_script\r\n    newCaseData.headers=JSON.parse(caseData.headers)\r\n    newCaseData.request.params=JSON.parse(caseData.request.params)\r\n    newCaseData.request.json=JSON.parse(caseData.request.json)\r\n    newCaseData.request.data=JSON.parse(caseData.request.data)\r\n    var res=await api.updateInterFaceCase(props.case_id,newCaseData)\r\n    if (res.status===200){\r\n        ElMessage({\r\n        type: 'success',\r\n        message: '保存成功',})\r\n        pstore.getInterFaces()\r\n    }\r\n    else{\r\n        ElMessage({\r\n        type: 'error',\r\n        message: '保存失败',})\r\n    }\r\n}\r\nvar resData=ref({})\r\n// 运行测试用例\r\nasync function runCase(params) {\r\n    const req_body={\r\n        env:pstore.env,\r\n        cases: {\r\n        title: caseData.title,\r\n        interface : caseData.interface,\r\n        headers: JSON.parse(caseData.headers),\r\n        request: {\r\n            params:JSON.parse(caseData.request.params)\r\n           },\r\n        setup_script: caseData.setup_script,\r\n        teardown_script:caseData.teardown_script\r\n     }\r\n    }\r\n    // 判断请求体的格式\r\n    if (bodyType.value==='json'){\r\n        req_body.cases.request.json=JSON.parse(caseData.request.json)\r\n    }\r\n    else if (bodyType.value==='data') {\r\n        req_body.cases.request.data=JSON.parse(caseData.request.data)\r\n    } else if (bodyType.value==='form_data'){\r\n        req_body.cases.request.file=caseData.request.file\r\n    }\r\n\r\n    var res=await api.runInterFaceCase(req_body)\r\n    if (res.status===200){\r\n        resData.value=res.data\r\n        drawer.value=true\r\n    }else{\r\n        ElMessage({\r\n                type: 'error',\r\n                message: '用例执行异常',\r\n                })\r\n    }\r\n}  \r\n\r\n// 定义输出前置脚本的用例模版\r\nfunction addSetupScript(item){\r\n    if (item === \"func\") {\r\n\t\t\tcaseData.setup_script += '\\n# 调用全局工具函数random_mobile随机生成一个手机号码\\nmobile = global_func.random_mobile()'\r\n\t\t} else if (item === \"global\") {\r\n\t\t\tcaseData.setup_script += '\\n# 设置局部变量\\ntest.save_global_variable(\"变量名\",\"变量值\")'\r\n\t\t} else if (item === \"env\") {\r\n\t\t\tcaseData.setup_script += '\\n# 设置局部变量\\ntest.save_env_variable(\"变量名\",\"变量值\")'\r\n\t\t} else if (item === \"sql\") {\r\n\t\t\tcaseData.setup_script +=\r\n\t\t\t\t'\\n # ----执行sql语句(需要在环境中配置数据库连接信息)----\\n # db.连接名.execute_all(sql语句) \\nsql = \"SELECT count(*) as count FROM futureloan.member\"\\nres = db.aliyun.execute_all(sql)'\r\n\t\t}\r\n}\r\n// 生成后置脚本\r\nfunction addTearDownCodeMod(item) {\r\n\t\tif (item === \"getBody\") {\r\n\t\t\tcaseData.teardown_script += '\\n# Demo:获取响应体(json)  \\nbody = response.json()';\r\n\t\t\tcaseData.teardown_script += '\\n# Demo2:获取响应体(字符串)  \\nbody = response.text';\r\n\t\t} else if (item === \"JSextract\") {\r\n\t\t\tcaseData.teardown_script +=\r\n\t\t\t\t'\\n# Demo:jsonpath提取response中的msg字段  \\nmsg = test.json_extract(response.json(),\"$..msg\")';\r\n\t\t} else if (item === \"REextract\") {\r\n\t\t\tcaseData.teardown_script += '\\n# Demo:正则提取响应体中的数据  \\nres = test.re_extract(response.text,\"正则表达式\",)';\r\n\t\t} else if (item === \"sql\") {\r\n\t\t\tcaseData.setup_script +=\r\n\t\t\t\t'\\n # ----执行sql语句(需要在环境中配置数据库连接信息)----\\n # db.连接名.execute_all(sql语句) \\nsql = \"SELECT count(*) as count FROM futureloan.member\"\\nres = db.aliyun.execute_all(sql)'\r\n\t\t} else if (item === \"global\") {\r\n\t\t\tcaseData.teardown_script += '\\n# 设置局部变量\\ntest.save_global_variable(\"变量名\",\"变量值\")'\r\n\t\t} else if (item === \"env\") {\r\n\t\t\tcaseData.teardown_script += '\\n# 设置局部变量\\ntest.save_env_variable(\"变量名\",\"变量值\")'\r\n\t\t} else if (item === \"func\") {\r\n\t\t\tcaseData.teardown_script += '\\n# 调用全局工具函数random_mobile随机生成一个手机号码\\nmobile = global_func.random_mobile()'\r\n\t\t} else if (item === \"http\") {\r\n\t\t\tcaseData.teardown_script +=\r\n\t\t\t\t'\\n# 断言http状态码 \\n# Demo:断言http状态码是否为200  \\ntest.assertion(\"相等\",200,response.status_code)';\r\n\t\t} else if (item === \"eq\") {\r\n\t\t\tcaseData.teardown_script += '\\n# 断言相等 \\ntest.assertion(\"相等\",\"预期结果\",\"实际结果\")';\r\n\t\t} else if (item === \"contain\") {\r\n\t\t\tcaseData.teardown_script += '\\n# 断言包含:预期结果中的内容在实际结果中是否存在 \\ntest.assertion(\"包含\",\"预期结果\",\"实际结果\")';\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n    .script_code{\r\n        display: flex;\r\n        .edido{\r\n            flex: 1;\r\n        }\r\n        .mod{\r\n            width: 300px;\r\n            height: 220px;\r\n            overflow: auto;\r\n\r\n        }\r\n    }\r\n    .buts{\r\n        text-align: center;\r\n        justify-content: center;\r\n        \r\n    }\r\n\r\n</style>","import script from \"./TestCase.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./TestCase.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./TestCase.vue?vue&type=style&index=0&id=1c48dc96&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1c48dc96\"]])\n\nexport default __exports__"],"names":["drawer","ref","pstore","ProjectStore","props","__props","openResutl","value","caseData","reactive","interface","url","method","headers","request","json","data","params","file","setup_script","teardown_script","title","bodyType","caseObj","async","getCaseInfo","case_id","res","api","getInterFacesCase","status","JSON","stringify","cleanData","delCase","ElMessageBox","confirm","confirmButtonText","cancelButtonText","type","then","delInterFaceCase","ElMessage","message","getInterFaces","catch","watch","id","newCaseData","copyCase","parse","addInterFaceCase","saveCase","updateInterFaceCase","resData","runCase","req_body","env","cases","runInterFaceCase","addSetupScript","item","addTearDownCodeMod","__exports__"],"sourceRoot":""}