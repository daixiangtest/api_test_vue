"use strict";(self["webpackChunkapi_test_vue"]=self["webpackChunkapi_test_vue"]||[]).push([[0],{2469:function(e,t,a){a.d(t,{N:function(){return o}});var l=a(2261),n=a(1552);const o=(0,l.nY)("proStore",{state:()=>({pro:{},env_list:[],env:0,inetrfaces:[],sceneList:[],taskList:[]}),getters:{interface1(){return this.inetrfaces.filter((e=>"1"===e.type))},interface2(){return this.inetrfaces.filter((e=>"2"===e.type))}},actions:{async getInterFaces(){const e=await n.A.getInterFaces(this.pro.id);200===e.status?this.inetrfaces=e.data:console.log(`获取项目id${this.pro.id}失败`)},async getScenes(){const e=await n.A.getScenes(this.pro.id);200===e.status&&(this.sceneList=e.data)},async getTestTask(){const e=await n.A.getTestTaskList(this.pro.id);200===e.status&&(this.taskList=e.data)}},persist:{enabled:!0,strategies:{key:"users",storage:localStorage}}})},5710:function(e,t,a){function l(e,t){var a={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var l in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+l+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?a[l]:("00"+a[l]).substr((""+a[l]).length)));return e}t.A={rTime(e){return l("yyyy-MM-dd hh:mm:ss",new Date(e))},rDate(e){return l("yyyy-MM-dd",new Date(e))},rhost(e){return l("yyyy-MM-dd hh:mm",new Date(e))}}},4e3:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var l=a(6768),n=a(4232),o=a(144),s=a(2469),i=a(1219),r=a(2933),u=a(1552),d=a(5710);const c={class:"card page-box left_card_box"},p={style:{"text-align":"center"},slot:"title"},k={key:0,style:{"font-size":"18px","font-weight":"bold"}},b={key:1,style:{"font-size":"18px","font-weight":"bold"}},m={slot:"footer",class:"dialog-footer",style:{"text-align":"center"}};var g={__name:"CrontabView",setup(e){const t=(0,s.N)(),a=(0,o.Kh)({cronList:null,dialogCron:!1,updateBtn:!0,cronTabData:{name:"冒烟测试定期执行",rule:"* * * * *",status:!0,task:null,env:null}});async function g(){const e=await u.A.getCronJob(t.pro.id);200===e.status&&(a.cronList=e.data)}async function y(e){const t=await u.A.updateCronJob(e.id,e);200===t.status?1==e.status?(0,i.nk)({type:"success",message:"定时运行已开启",duration:1e3}):(0,i.nk)({type:"warning",message:"定时运行已关闭",duration:1e3}):(0,i.nk)({type:"error",message:"修改状态失败",duration:1e3})}function f(e){r.s.confirm("此操作将永久删除该定时任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await u.A.delCronJob(e);204===t.status&&((0,i.nk)({type:"success",message:"删除成功!"}),g())})).catch((()=>{(0,i.nk)({type:"info",message:"已取消删除"})}))}function h(){a.dialogCron=!0,a.updateBtn=!1}async function v(){const e={project:t.pro.id,...a.cronTabData},l=await u.A.addCronJob(e);201===l.status&&((0,i.nk)({type:"success",message:"定时任务添加成功",duration:1e3}),a.dialogCron=!1,g())}function w(e){a.cronTabData={...e},a.dialogCron=!0,a.updateBtn=!0}async function x(){const e=await u.A.updateCronJob(a.cronTabData.id,a.cronTabData);200===e.status&&((0,i.nk)({type:"success",message:"修改成功",duration:1e3}),a.dialogCron=!1,g())}return g(),(e,s)=>{const i=(0,l.g2)("el-button"),r=(0,l.g2)("el-table-column"),u=(0,l.g2)("el-switch"),g=(0,l.g2)("el-tooltip"),F=(0,l.g2)("el-table"),L=(0,l.g2)("el-input"),_=(0,l.g2)("el-form-item"),C=(0,l.g2)("el-option"),T=(0,l.g2)("el-select"),V=(0,l.g2)("el-col"),D=(0,l.g2)("el-row"),z=(0,l.g2)("el-form"),W=(0,l.g2)("el-drawer");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",c,[(0,l.bF)(i,{plain:"",onClick:h,style:{margin:"10px 5px"},type:"primary",icon:"Plus",size:"small"},{default:(0,l.k6)((()=>s[9]||(s[9]=[(0,l.eW)("添加定时任务")]))),_:1}),(0,l.bF)(F,{data:a.cronList,style:{width:"100%"},size:"small",border:""},{default:(0,l.k6)((()=>[(0,l.bF)(r,{label:"创建时间","min-width":"180"},{default:(0,l.k6)((e=>[(0,l.eW)((0,n.v_)((0,o.R1)(d.A).rTime(e.row.create_time)),1)])),_:1}),(0,l.bF)(r,{prop:"name",label:"名称","min-width":"140"}),(0,l.bF)(r,{prop:"task_name",label:"执行任务","min-width":"140"}),(0,l.bF)(r,{prop:"env_name",label:"执行环境","min-width":"140"}),(0,l.bF)(r,{prop:"rule",label:"执行规则","min-width":"140"}),(0,l.bF)(r,{label:"是否开启","min-width":"120"},{default:(0,l.k6)((e=>[(0,l.bF)(u,{onChange:t=>y(e.row),modelValue:e.row.status,"onUpdate:modelValue":t=>e.row.status=t,"active-color":"#13ce66","inactive-color":"#b1b1b1"},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),(0,l.bF)(r,{label:"操作","min-width":"100"},{default:(0,l.k6)((e=>[(0,l.bF)(g,{class:"item",effect:"dark",content:"编辑",placement:"top"},{default:(0,l.k6)((()=>[(0,l.bF)(i,{onClick:t=>w(e.row),type:"primary",size:"small",plain:"",icon:"Edit"},null,8,["onClick"])])),_:2},1024),(0,l.bF)(g,{class:"item",effect:"dark",content:"删除",placement:"top"},{default:(0,l.k6)((()=>[(0,l.bF)(i,{onClick:t=>f(e.row.id),type:"danger",size:"small",plain:"",icon:"Delete"},null,8,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])]),(0,l.bF)(W,{modelValue:a.dialogCron,"onUpdate:modelValue":s[8]||(s[8]=e=>a.dialogCron=e),width:"30%"},{header:(0,l.k6)((()=>[(0,l.Lk)("div",p,[a.updateBtn?((0,l.uX)(),(0,l.CE)("span",k,"修改定时执行任务")):((0,l.uX)(),(0,l.CE)("span",b,"创建定时执行任务"))])])),default:(0,l.k6)((()=>[(0,l.bF)(z,{model:a.cronTabData,"label-width":"80px"},{default:(0,l.k6)((()=>[(0,l.bF)(_,{label:"名称"},{default:(0,l.k6)((()=>[(0,l.bF)(L,{modelValue:a.cronTabData.name,"onUpdate:modelValue":s[0]||(s[0]=e=>a.cronTabData.name=e)},null,8,["modelValue"])])),_:1}),(0,l.bF)(_,{label:"测试环境"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{modelValue:a.cronTabData.env,"onUpdate:modelValue":s[1]||(s[1]=e=>a.cronTabData.env=e),placeholder:"请选择环境",style:{width:"100%"}},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,o.R1)(t).env_list,(e=>((0,l.uX)(),(0,l.Wv)(C,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(_,{label:"执行计划"},{default:(0,l.k6)((()=>[(0,l.bF)(T,{style:{width:"100%"},modelValue:a.cronTabData.task,"onUpdate:modelValue":s[2]||(s[2]=e=>a.cronTabData.task=e),placeholder:"请选择"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)((0,o.R1)(t).taskList,(e=>((0,l.uX)(),(0,l.Wv)(C,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.bF)(_,{label:"是否开启"},{default:(0,l.k6)((()=>[(0,l.bF)(u,{modelValue:a.cronTabData.status,"onUpdate:modelValue":s[3]||(s[3]=e=>a.cronTabData.status=e),"active-color":"#79d0ff","inactive-color":"#c3c3c3",size:"small"},null,8,["modelValue"])])),_:1}),(0,l.bF)(_,{label:"定时规则"},{default:(0,l.k6)((()=>[(0,l.bF)(L,{modelValue:a.cronTabData.rule,"onUpdate:modelValue":s[4]||(s[4]=e=>a.cronTabData.rule=e),placeholder:"* * * * *"},null,8,["modelValue"]),(0,l.bF)(D,{gutter:20},{default:(0,l.k6)((()=>[(0,l.bF)(V,{span:14},{default:(0,l.k6)((()=>s[10]||(s[10]=[(0,l.Lk)("h5",null,"规则说明:",-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("* * * * * "),(0,l.Lk)("span",{style:{color:"#909399"}},"分别表示 minute hour week day month ")],-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("minute： "),(0,l.Lk)("span",{style:{color:"#909399"}},"表示分钟，可以是从0到59之间的任何整数。")],-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("hour："),(0,l.Lk)("span",{style:{color:"#909399"}},"表示小时，可以是从0到23之间的任何整数。")],-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("week："),(0,l.Lk)("span",{style:{color:"#909399"}},"表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。")],-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("day："),(0,l.Lk)("span",{style:{color:"#909399"}},"表示日期，可以是从1到31之间的任何整数。")],-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("month："),(0,l.Lk)("span",{style:{color:"#909399"}},"表示月份，可以是从1到12之间的任何整数。")],-1)]))),_:1}),(0,l.bF)(V,{span:10},{default:(0,l.k6)((()=>s[11]||(s[11]=[(0,l.Lk)("h5",null,"配置案例：",-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("5 * * * * : "),(0,l.Lk)("span",{style:{color:"#909399"}},"每小时的第5分钟执行一次任务")],-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("30 9 * * * : "),(0,l.Lk)("span",{style:{color:"#909399"}},"每天上午的 9:30 执行一次任务")],-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("30 9 * 8 * : "),(0,l.Lk)("span",{style:{color:"#909399"}},"每月8号上午的9:30执行一次任务 ")],-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("30 9 * 5 3 : "),(0,l.Lk)("span",{style:{color:"#909399"}}," 每年的3月5日9:30执行一次任务")],-1),(0,l.Lk)("div",{style:{"font-size":"12px","line-height":"16px"}},[(0,l.eW)("30 9 0 * * : "),(0,l.Lk)("span",{style:{color:"#909399"}},"每星期日的上午9:30执行一次任务")],-1)]))),_:1})])),_:1})])),_:1})])),_:1},8,["model"]),(0,l.Lk)("div",m,[(0,l.bF)(i,{onClick:s[5]||(s[5]=e=>a.dialogCron=!1),size:"small"},{default:(0,l.k6)((()=>s[12]||(s[12]=[(0,l.eW)("取 消")]))),_:1}),a.updateBtn?((0,l.uX)(),(0,l.Wv)(i,{key:0,type:"primary",onClick:s[6]||(s[6]=e=>x()),size:"small"},{default:(0,l.k6)((()=>s[13]||(s[13]=[(0,l.eW)("提交修改")]))),_:1})):((0,l.uX)(),(0,l.Wv)(i,{key:1,type:"primary",onClick:s[7]||(s[7]=e=>v()),size:"small",plain:""},{default:(0,l.k6)((()=>s[14]||(s[14]=[(0,l.eW)("创 建")]))),_:1}))])])),_:1},8,["modelValue"])],64)}}};const y=g;var f=y}}]);
//# sourceMappingURL=0.b27de2e7.js.map